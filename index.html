<!DOCTYPE html>
<html>

<head>

    <!-- Ionicons -->

    <!-- Theme style -->
    <link rel="stylesheet" href="dist/css/adminlte.min.css">
    <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/jquery"></script>
     <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.0/dist/echarts.min.js"></script>
    <!-- bug原因：原文定义了tooltip，忘记cv原来的tooltip -->
    <style>
        .tooltip {
            position: absolute;
            pointer-events: none;
            font-size: 8px;
            opacity: 1;
        }

        .southchinasea {
            stroke: black;
            stroke-width: 1px;
            fill: rgb(16, 53, 239);
            fill: rgb(163, 192, 228); 
        }

        img {
            border: 0.3px solid black;
        }

        .box {
            position: absolute;
            z-index: 320;
            box-sizing: border-box;
            margin: 0;
            padding: 5px;
            box-shadow: rgba(153, 217, 234, 0.9) 0px 0px 05px inset;
            background: linear-gradient(to left, #00A2E8, #00A2E8) left top no-repeat,
                linear-gradient(to bottom, #00A2E8, #00A2E8) left top no-repeat,
                linear-gradient(to left, #00A2E8, #00A2E8) right top no-repeat,
                linear-gradient(to bottom, #00A2E8, #00A2E8) right top no-repeat,
                linear-gradient(to left, #00A2E8, #00A2E8) left bottom no-repeat,
                linear-gradient(to bottom, #00A2E8, #00A2E8) left bottom no-repeat,
                linear-gradient(to left, #00A2E8, #00A2E8) right bottom no-repeat,
                linear-gradient(to left, #00A2E8, #00A2E8) right bottom no-repeat;
            background-size: 3px 10px, 10px 3px, 3px 10px, 10px 3px;
            /* 左侧左右，左侧上下，右侧左右，右侧上下，粗读，长度*/
        }
    </style>

    <meta charset="utf-8">
    <title>中国近年GDP</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="http://d3js.org//d3.v7.js" charset="utf-8"></script>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            height: 100%;
            font-family:'SimHei';
            
            
             /* background-color: #2f2f34;  */
        }
    </style>
</head>
<body background="pic/background5.jpg" style="background-repeat:no-repeat;
background-size:100% 100%;
z-index: -1; 
position:fixed;">
    <!-- 地图和时间轴 -->
    <div id="timebar" class="box" style="position: absolute;margin: 0;">

        <form>
            <!-- 年份选择: <span id="year-val"></span> -->
            <input id="year" class="custom-range" type="range" step="1">
        </form>

    </div>
    <div id="map" class="box" style="position: absolute">
        <svg>
            <text id="title"></text>
            <text id="content"></text>
        </svg>
        <div id="fortooltip"></div>
    </div>
    <!-- 饼图 -->
    <div id="pie" class="box" style="position: absolute">
        <h3 style="font-size:18px;font-family: SimHei;font-weight: bold;color:rgb(209, 199, 199);text-align:center">该年省份三产业占比</h3>
        <svg>
            <text id="dxwtitle"></text>
        </svg>
    </div>
    <!-- 图片 -->
    <style>
        #richtext{
            color:white
        }
    </style>
    <div id="pic" class="box" style="position: absolute">
        <p id="richtext" style="text-align:center;font-size:18px;font-family: SimHei;font-weight: bold;color:rgb(209, 199, 199)">请选择一个省份<br/></p> 
        <img id="richimg" src="pic/default.gif" style="border:none;text-align: center;position:relative;left:25%;top:10%" height="50%" width="50%">
    </div>
    <!-- 柱状图 -->
    <div id="bar" class="box" style="position: absolute">    </div>
    <!-- 折线图1-xw -->
    <div id="line1xw" class="box" style="position: absolute;color:rgb(232, 239, 238)">
        <svg>
            <text id="dxwtitle"></text>
        </svg>
    </div>
    <!-- 折线图2-ykn -->
    <div id="line2ykn" class="box" style="position: absolute">
        
    </div>

    <script>
        //宽度左右总体6：4//6:2:2
        //高度上下总体7：3//3:4:3
        //var height=window.screen.height
        var height = window.innerHeight
        var width = window.innerWidth
        var map = document.getElementById("map");
        var timebar = document.getElementById("timebar");
        var pie = document.getElementById("pie");
        var pic = document.getElementById("pic");
        var bar = document.getElementById("bar");//left right一般不需要设定看宽度，但是高度需要设定
        var line1xw = document.getElementById("line1xw");
        var line2ykn = document.getElementById("line2ykn");
        console.log(height)
        //timebar
        timebar.style.left = 0 + 'px'
        timebar.style.top = 0 + 'px'
        timebar.style.height = 0.05 * height + 'px'
        timebar.style.width = 0.5 * width + 'px'
        //map
        map.style.left = 0 + 'px'
        map.style.top = 0.05 * height + 'px'
        map.style.height = 0.65 * height + 'px'
        map.style.width = 0.5 * width + 'px'
        //line1xw
        line1xw.style.left = 0 + 'px'
        line1xw.style.top = 0.7 * height + 'px'
        line1xw.style.height = 0.3 * height + 'px'
        line1xw.style.width = 0.5 * width + 'px'
        //line2ykn
        line2ykn.style.left = 0.5 * width + 'px'
        line2ykn.style.top = 0.7 * height + 'px'
        line2ykn.style.height = 0.3 * height + 'px'
        line2ykn.style.width = 0.5 * width + 'px'
        //pie
        pie.style.left = 0.5 * width + 'px'
        pie.style.top = 0 + 'px'
        pie.style.height = 0.3 * height + 'px'
        pie.style.width = 0.3 * width + 'px'
        //pic
        pic.style.left = 0.8 * width + 'px'
        pic.style.top = 0 + 'px'
        pic.style.height = 0.3 * height + 'px'
        pic.style.width = 0.2 * width + 'px'
        //bar
        bar.style.left = 0.5 * width + 'px'
        bar.style.top = 0.3 * height + 'px'
        bar.style.height = 0.4 * height + 'px'
        bar.style.width = 0.5 * width + 'px'
        //0.3*0.5
        //  div5[0].style.width = 0.15 * width + 'px'
        //  //div5[0].style.float='left'
        //  div6[0].style.width = 0.15 * width + 'px'
    </script>
    <script>
        //把数据处理成按顺序的数据，从而可以表示出该一年全国地图的数据样式
        //单机省份获得省名查表得到对应的index，如何做filter操作？
        let province='中国'
        var tdict = { '新疆维吾尔自治区': 0, '西藏自治区': 1, '内蒙古自治区': 2, '青海省': 3, '四川省': 4, '黑龙江省': 5, '甘肃省': 6, '云南省': 7, '广西壮族自治区': 8, '湖南省': 9, '陕西省': 10, '广东省': 11, '吉林省': 12, '河北省': 13, '湖北省': 14, '贵州省': 15, '山东省': 16, '江西省': 17, '河南省': 18, '辽宁省': 19, '山西省': 20, '安徽省': 21, '福建省': 22, '浙江省': 23, '江苏省': 24, '重庆市': 25, '宁夏回族自治区': 26, '海南省': 27, '台湾省': 28, '北京市': 29, '天津市': 30, '上海市': 31, '香港': 32, '澳门': 33 }
        console.log(tdict)
        //导入data，需要联动上bar 
        drawMap(2019, 0)
        dxw_Broken_line_diagram();
        var currentYear = 2019//js之间由于存在异步问题，所以函数调用的时候要把参数传入到函数参数中，尽管你已经进行了定义！
        //用于最开始显示年份的，注释掉之后最开始不会显示年份
        // d3.select("#year-val").text(1987)
        d3.select("#year")
            .property("min", 1987)
            .property("max", 2019)
            .property("value", currentYear)
            .on("input", () => {
                // d3.select('body').select('svg').remove()
                currentYear = +d3.select("#year").property("value");  //获得当前年份信息     
                // d3.select("#year-val").text(currentYear)//用于显示年份 
                drawMap(currentYear, 1);//根据年份绘制大的中国地图，绘制中国地图的时候会调用绘制其他的小图片
            });
        
        function drawMap(currentYear, flag) {
            var totaldata = d3.dsv(",", "data/data.csv", (d) => {
                return {
                    year: d.Year,
                    provence: d.Provence,
                    GDP: +d.tGDP,
                    first_num: +d.first_num,// + convert  column to number
                    second_num: +d.second_num,
                    third_num: +d.third_num,
                    first_por: +d.first_por,
                    second_por: +d.second_por,
                    third_por: +d.third_por,
                    avgpeople: +d.avgpeople
                };
            }).then(function (data) {
                // console.log(data.filter(function (d) { return d.provence == '山东省' }))
                //处理时间即可
                //console.log(data)
                ready(data, currentYear, flag)
            })
        } //实现datafilter

        //todo!! 写函数，在ready里面调用
        function showAvgPeople(totaldata, currentYear, provence) {
            if (provence == "中国") {
                //console.log("dd")
                return
            }
            var dlength = 35
            var theprov = 0 //当前省当年平均gdp
            var country = 0 //全国当年平均gdp
            var maxgdp = 0
            var mingdp = 114514
            var level = ""
            for (let i = 0; i < dlength; i++) {
                var value = totaldata[(currentYear - 1987) * dlength + i]
                if (value.provence == "中国") {
                    country = value.avgpeople
                }
                else if (value.avgpeople != 0){
                    if (value.provence == provence) {
                        theprov = value.avgpeople
                    }
                    maxgdp = Math.max(maxgdp, value.avgpeople)
                    mingdp = Math.min(mingdp, value.avgpeople)
                }
            }
            console.log(theprov)
            console.log(country)
            console.log(maxgdp)
            console.log(mingdp)
            var borderline = 1.0
            if (country >= 7000) {
                borderline = 0.5
            }
            //贫困和特困
            country = country * borderline
            if (theprov <= country) {
                var norm = (theprov - mingdp) / (country - mingdp)
                if (norm <= 0.2) {
                    level = "verypoor"
                    document.getElementById("richtext").innerHTML=provence + currentYear + "年的人均gdp为" + theprov + "元<br/>为特别贫困水平"
                }
                else {
                    level = "poor"
                    document.getElementById("richtext").innerHTML=provence + currentYear + "年的人均gdp为" + theprov + "元<br/>为贫困水平"
                }
            }
            //小康和富裕
            else {
                var norm = (theprov - country) / (maxgdp - country)
                if (norm <= 0.6) {
                    level = "rich"
                    document.getElementById("richtext").innerHTML=provence + currentYear + "年的人均gdp为" + theprov + "元<br/>为小康水平"
                }
                else {
                    level = "veryrich"
                    document.getElementById("richtext").innerHTML=provence + currentYear + "年的人均gdp为" + theprov + "元<br/>为富裕水平"
                }
            }
            if (theprov >= 30000) {
                level = "rich"
                document.getElementById("richtext").innerHTML=provence + currentYear + "年的人均gdp为" + theprov + "元<br/>为小康水平"
            }
            if (theprov >= 50000) {
                level = "veryrich"
                document.getElementById("richtext").innerHTML=provence + currentYear + "年的人均gdp为" + theprov + "元<br/>为富裕水平"
            }
            if (theprov == 0) {
                level = "nodata"
                document.getElementById("richtext").innerHTML="暂无该省数据<br/>"
            }
            document.getElementById("richimg").src='pic/'+level + ".gif"
        }

        function dxw_Broken_line_diagram(){//省份近10年的各产业GDP折线图
            //每当鼠标点击时调用一次
            var dxwdata;
            var dxwdex = {"first_num": "第一产业", "second_num": "第二产业", "third_num": "第三产业", "tGDP": "总GDP"}
            //选取2010年到2019年province的数据

            d3.csv("data/xwdata.csv",function(csvdata){ 
                //console.log(csvdata);
                return csvdata; 
            }).then(function (data) {
                dxwdata=data.filter(function (d) { return d.year >= "1987" && d.Provence==province})
            }).then(()=>{
                console.log(dxwdata)
                chart = IndexChart(dxwdata, {
                    x: d => +d.year,
                    y: d => +d.GDP,
                    //z: d => d.number,
                    z: d => dxwdex[d.number],
                    yLabel: province+"第一二三产业GDP发展折线图",
                })
                //console.log(province)
                //date = Generators.input(chart)
                function IndexChart(data, {
                    x = ([x]) => x, // given d in data, returns the (temporal) x-value
                    y = ([, y]) => y, // given d in data, returns the (quantitative) y-value
                    z = () => 1, // given d in data, returns the (categorical) z-value for series
                    defined, // for gaps in data
                    curve = d3.curveLinear, // how to interpolate between points
                    marginTop = 30, // top margin, in pixels
                    marginRight = 40, // right margin, in pixels
                    marginBottom = 30, // bottom margin, in pixels
                    marginLeft = 40, // left margin, in pixels
                    width = window.innerWidth*0.5, // outer width, in pixels
                    height = window.innerHeight*0.3, // outer height, in pixels
                    xType = d3.scaleLinear, // the x-scale type
                    xDomain, // [xmin, xmax]
                    xRange = [marginLeft, width - marginRight], // [left, right]
                    xFormat, // a format specifier string for the x-axis
                    yType = d3.scaleLog, // the y-scale type
                    yDomain, // [ymin, ymax]
                    yRange = [height - marginBottom, marginTop], // [bottom, top]
                    yFormat = "", // a format specifier string for the y-axis
                    yLabel, // a label for the y-axis
                    zDomain, // array of z-values
                    //formatDate = "%y", // format specifier string for dates (in the title)
                    colors = d3.schemeTableau10, // array of categorical colors
                } = {}) {
                    // Compute values.
                    //console.log(province)
                    const X = d3.map(data, x);
                    const Y = d3.map(data, y);
                    const Z = d3.map(data, z);
                    if (defined === undefined) defined = (d, i) => !isNaN(X[i]) && !isNaN(Y[i]);
                    const D = d3.map(data, defined);

                    // Compute default x- and z-domains, and unique the z-domain.
                    if (xDomain === undefined) xDomain = d3.extent(X);
                    if (zDomain === undefined) zDomain = Z;
                    zDomain = new d3.InternSet(zDomain);

                    // Omit any data not present in the z-domain.
                    const I = d3.range(X.length).filter(i => zDomain.has(Z[i]));
                    const Xs = d3.sort(I.filter(i => D[i]).map(i => X[i])); // for bisection later
                    // Compute default y-domain.
                    if (yDomain === undefined) {
                        const r = I => d3.max(I, i => Y[i]) / d3.min(I, i => Y[i]);
                        const k = d3.max(d3.rollup(I, r, i => Z[i]).values());
                        yDomain = [1 / k, k];
                        //console.log(r)
                        console.log(k)
                    }
                    //console.log(I, i => Y[i])
                    //console.log(d3.min(I, i => Y[i]))
                    console.log(yDomain)
                    //console.log(Y)
                    // Construct scales and axes.
                    const xScale = xType(xDomain, xRange).interpolate(d3.interpolateRound);
                    const yScale = yType(yDomain, yRange);
                    const color = d3.scaleOrdinal(zDomain, colors);
                    const xAxis = d3.axisBottom(xScale).ticks(width / 160, xFormat).tickSizeOuter(0);
                    const yAxis = d3.axisLeft(yScale).ticks(null, yFormat);

                    // Construct formats.
                    //formatDate = xScale.tickFormat(null, formatDate);

                    // Construct a line generator.
                    const line = d3.line()
                        .defined(i => D[i])
                        .curve(curve)
                        .x(i => xScale(X[i]))
                        .y((i, _, I) => yScale(Y[i] / Y[I[0]]));

                    var svg = d3.select("body").select("#line1xw").select("svg")
                        .attr("width", width)
                        .attr("height", height)
                        .attr("viewBox", [0, 0, width, height])
                        .attr("style", "max-width: 100%; height: auto; height: intrinsic;")
                        .attr("font-family", "sans-serif")
                        .attr("font-size", 10)
                        .on("touchstart", event => event.preventDefault())
                        .on("pointermove", pointermoved);
                    
                    d3.select("body").select("#line1xw").select("svg").selectAll('*').remove();
                    
                    svg.append("g")
                        .attr("transform", `translate(0,${height - marginBottom})`)
                        .call(xAxis)
                        .style("color","rgb(209, 199, 199)")
                        .call(g => g.select(".domain").remove());

                    svg.append("g")
                        .attr("transform", `translate(${marginLeft},0)`)
                        .call(yAxis)
                        .call(g => g.select(".domain").remove())
                        .call(g => g.selectAll(".tick line").clone()
                            .attr("stroke-opacity", d => d === 1 ? null : 0.2)
                            .attr("x2", width - marginLeft - marginRight))
                        .call(g => g.append("text")
                            .attr("x", -marginLeft)
                            .attr("y", 20)
                            .attr("fill", "currentColor")
                            .attr("text-anchor", "start")
                            .attr('font-size','18px')
                            .attr('font-weight','bold')
                            .text(yLabel))
                            .style("color","rgb(209, 199, 199)");

                    const rule = svg.append("g");

                    rule.append("line")
                        .attr("y1", marginTop)
                        .attr("y2", height - marginBottom - 15)
                        .attr("stroke", "currentColor");

                    const ruleLabel = rule.append("text")
                        .attr("y", height - marginBottom - 15)
                        .attr("fill", "currentColor")
                        .attr("text-anchor", "middle")
                        .attr("dy", "1em");

                    const serie = svg.append("g")
                        .selectAll("g")
                        .data(d3.group(I, i => Z[i]))
                        .join("g");

                    serie.append("path")
                        .attr("fill", "none")
                        .attr("stroke-width", 3)
                        .attr("stroke-linejoin", "round")
                        .attr("stroke-linecap", "round")
                        .attr("stroke", ([z]) => color(z))
                        .attr("d", ([, I]) => line(I));

                    serie.append("text")
                        .attr("font-weight", "bold")
                        .attr("fill", "none")
                        .attr("stroke", "white")
                        .attr("stroke-width", 3)
                        .attr("stroke-linejoin", "round")
                        .attr("x", ([, I]) => xScale(X[I[I.length - 1]]))
                        .attr("y", ([, I]) => yScale(Y[I[I.length - 1]] / Y[I[0]]))
                        .attr("dx", 3)
                        .attr("dy", "0.35em")
                        .text(([z]) => z)
                        .clone(true)
                        .attr("fill", ([z]) => color(z))
                        .attr("stroke", null);

                    function update(date) {
                        date = Xs[d3.bisectCenter(Xs, date)];
                        rule.attr("transform", `translate(${xScale(date)},0)`);
                        //ruleLabel.text(formatDate(date));
                        serie.attr("transform", ([, I]) => {
                        const i = I[d3.bisector(i => X[i]).center(I, date)];
                        return `translate(0,${yScale(1) - yScale(Y[i] / Y[I[0]])})`;
                        });
                        svg.property("value", date).dispatch("input", {bubbles: true}); // for viewof
                    }

                    function pointermoved(event) {
                        update(xScale.invert(d3.pointer(event)[0]));
                    }

                    update(xDomain[0]);

                    return Object.assign(svg.node(), {scales: {color}, update});
                }
            })
            //console.log(province)
        }
        function bingtudraw(totaldata, currentYear) {
            var lzpdata;
            //选取2010年到2019年province的数据
            lzpdata = totaldata.filter(function (d) { return d.year == currentYear && d.provence == province })
            // console.log("lzp")
            console.log(lzpdata)
            chart = PieChart(lzpdata, {
                width: window.innerWidth * 0.28,
                height: window.innerHeight * 0.25
            })
            function PieChart(data, {
                title, // given d in data, returns the title text
                width = 1200, // outer width, in pixels
                height = 1000, // outer height, in pixels
                innerRadius = 0, // inner radius of pie, in pixels (non-zero for donut)
                outerRadius = Math.min(width, height) / 2, // outer radius of pie, in pixels
                labelRadius = (innerRadius * 0.2 + outerRadius * 0.8), // center radius of labels
                format = ",", // a format specifier for values (in the label)
                names, // array of names (the domain of the color scale)
                colors, // array of colors for names
                stroke = innerRadius > 0 ? "none" : "white", // stroke separating widths
                strokeWidth = 1, // width of stroke separating wedges
                strokeLinejoin = "round", // line join of stroke separating wedges
                padAngle = stroke === "none" ? 1 / outerRadius : 0, // angular separation between wedges
            } = {}) {
                radius = 100
                var dataset = []
                dataset.push(['第一产业', data[0].first_num.toFixed(2) + "亿元"])
                dataset.push(['第二产业', data[0].second_num.toFixed(2) + "亿元"])
                dataset.push(['第三产业', data[0].third_num.toFixed(2) + "亿元"])
                //var he = data[0].first_num + data[0].second_num + data[0].second_num

                console.log(dataset)
                var color = [d3.rgb(13, 101, 223), '#10a3e2', d3.rgb(163, 192, 228)]
                const svg = d3.select("body").select("#pie").select("svg")
                    .attr("width", width)
                    .attr("height", height)
                    .attr("viewBox", [0, 0, width*1.1, height])
                    .attr("style", "max-width: 100%; height: auto; height: intrinsic;");
                d3.select("body").select("#pie").select("svg").selectAll('*').remove();
                const pie = d3.pie()   //饼图布局
                    .sort(null)             //不排序，不写则会从大到小，顺时针排序。
                    .value(function (d) { return d[1] });
                const pie2 = d3.pie();
                var cdata = []
                cdata.push([data[0].first_por])
                cdata.push([data[0].second_por])
                cdata.push([data[0].third_por])
                const piedata = pie(dataset);
                const piedata2 = pie2(cdata);
                const arc = d3.arc() //弧生成器 //设置内半径
                    .outerRadius(outerRadius); //设置外半径
                var sum = 0;
                piedata.forEach(function (d, i) {
                    d._endAngle = d.endAngle;
                    d.endAngle = d.startAngle;
                    d.duration = 500;
                    d.delaytime = sum;
                    sum += d.duration;
                })
                const arcs = svg.selectAll(".arc")
                    .data(piedata2) //返回是pie(data0)
                    .enter().append("g")
                    .attr("class", "arc")
                    .attr("transform", "translate(" + (width / 4 + 20) + "," + (height / 3 + 30) + ")")   //将圆心平移到svg的中心
                    .append("path")
                    .attr("fill", function (d, i) {
                        return color[i];
                    })
                    .transition()					//设置动画
                    .ease(d3.easeBounce)					//动画效果
                    .duration(2000)					//持续时间
                    .attrTween('d', tweenPie)		//两个属性之间平滑的过渡。
                    .transition()
                    .ease(d3.easeElastic)
                    .delay(function (d, i) { return 100 + i * 50 })	//设置了一个延迟时间，让每一个内半径不在同一个时间缩小。
                    .duration(750)
                    .attrTween('d', tweenDonut);

                const label = svg.selectAll('.label')      //添加右上角的标签
                    .data(piedata)
                    .enter()
                    .append('g')
                    .attr("transform", "translate(" + (width - 100) + "," + 10 + ")")

                emoji=['🌾','⚙️','👩‍💼']
                label.append('rect')        //标签中的矩形
                    .style('fill', function (d, i) {
                        return color[i];
                    })
                    .attr('x', function (d, i) {
                        return -70;
                    })
                    .attr("y", function (d, i) {
                        return 10 + i * 30;
                    })
                    .attr('rx', '5')     //rx=ry 会出现圆角
                    .attr('ry', '5')
                    .attr('width', 220)
                    .attr('height', 30)
                    ;

                label.append('text')            //标签中的文字
                    .attr('x', function (d, i) {
                        return -60;              //因为rect宽度是50，所以把文字偏移25,在后面再将文字设置居中
                    })
                    .attr("y", function (d, i) {
                        return 20 + 10 + i * 30;
                    })
                    .text(function (d,i) {
                        return emoji[i]+''+d.data[0]+' '+d.data[1];
                    })
                    .attr('text-align','center')
                    .attr('font-size','16px')
                   
                    // .style({
                    //     "font-size": "2px",
                    //     "text-anchor": "middle",
                    //     'fill':'rgb(209, 199, 199)',
                    //     "font-weight": 500,
                    //     'text-align': 'center',
                    //     'margin':'20px',
                    //     'padding':'100px'
                    // })
                
                function tweenPie(b) {
                    //这里将每一个的弧的开始角度和结束角度都设置成了0
                    //然后向他们原始的角度(b)开始过渡，完成动画。
                    b.innerRadius = 0;
                    var i = d3.interpolate({ startAngle: 0, endAngle: 0 }, b);
                    //下面的函数就是过渡函数，他是执行多次最终达到想要的状态。
                    return function (t) { return arc(i(t)); };
                }

                function tweenDonut(b) {
                    //设置内半径不为0
                    b.innerRadius = radius * .6;
                    //然后内半径由0开始过渡
                    var i = d3.interpolate({ innerRadius: 0 }, b);
                    return function (t) { return arc(i(t)); };
                }
                function tweenArc(b) {
                    return function (a, i) {
                        var d = b.call(this, a, i),
                            i = d3.interpolate(a, d);
                        return function (t) {
                            return arc(i(t));
                        };
                    };
                }
                return svg.node();
            }
        }
        //然后每次一改变时间就调用ready，ready里面再调用其他的小的组件（你们写的内容）
        function ready(totaldata, currentYear, flag) {
            console.log(totaldata)
            console.log(currentYear)
            console.log(province)
            showAvgPeople(totaldata, currentYear, province)
            bingtudraw(totaldata, currentYear)
            var bias = 1987
            var dlength = 35//省份34个，算上中国35个

            var provence
            var width = window.innerWidth * 0.6 * 0.8;
            var height = window.innerHeight * 0.7 * 0.9 * 0.98;

            var svg = d3.select("body").select("#map").select("svg")
                .attr("width", width)
                .attr("height", height);


            var covid = []
            var dif = currentYear - bias
            for (let i = 0; i < dlength - 1; i++) {

                covid.push(totaldata[dif * dlength + i].GDP)
            }
            //用来更改颜色
            var max = Math.max.apply(null, covid)
            var min = Math.min.apply(null, covid)

            console.log(covid)
            //var covid = [591, 113, 2, 0, 1, 5, 238, 0, 2330, 7, 392, 0, 102, 2, 8, 150, 0, 7, 103, 15, 0, 5, 212, 1, 12, 0, 2, 0, 16, 0, 0, 260761, 0, 0, 1371462]
            
            var color = ['#fff7ec', '#fee8c8', '#fdd49e', '#fdbb84',
                '#fc8d59', '#ef6548', '#d7301f', '#b30000', 'rgb(153, 0, 0)'];
            var b = d3.rgb(16, 53, 239);	//红色
            var a = d3.rgb(163, 192, 228);	//绿色
            var compute = d3.interpolate(a, b);
            var linear = d3.scaleSqrt()
                .domain([100, 110000])// .domain([min, max])//.domain([100, 110000]) 
                .range([0, 1]);
            //定义地图的投影
            // console.log(width)
            // console.log(height)
            var projection = d3.geoMercator()
                .center([105, 38])
                .scale(width * 0.8)
                .translate([width / 2, height / 2]);

            //定义地形路径生成器
            var geoPath = d3.geoPath()
                .projection(projection); //设定投影

            d3.json("data/China.json").then(function (data) {         //先执行完then之前的，再执行then之后的

                var scaleColor = d3.scaleOrdinal()
                    .domain(d3.range(data.features.length))
                    .range(d3.schemeCategory10);
                if (flag == 0) {//改的时候注意改两份！
                    var groups = svg.append("g");//svg中，代表小组容器g
                    var tooltip = d3.select("body")
                        .select("#fortooltip")
                        .attr("class", "tooltip")
                        .style("background-color", "#d3d3d3")
                        .style("border-radius", "3px")
                        .style("padding", "5px");
                    groups.selectAll("path")
                        .data(data.features)
                        .enter()// enter+append !!If the body is initially empty, the above code will create six new DIV elements, append them to the body in-order
                        .append("path")
                        .attr("class", "province")
                        .attr("stroke", "#333")
                        .attr("stroke-width", "0.2px")
                        .attr("info", (d, i) => covid[i])//添加数据到info
                        .attr("fill", function (d, i) {//todo：转成线性变换！
                            return compute(linear(covid[i]))

                        })

                        .attr("d", (d, i) => geoPath(d))  //使用路径生成器
                        .on("click", function (d, i) {
                            console.log(i.properties.name);
                            //!!定义了省份名，用作各个的接口

                            provence = i.properties.name
                            province = provence
                            const change = d3.select(this)//this是选中的框的内容
                                .attr("stroke-width", "1.5px")
                            var t = change.attr("info")//数据被添加到了info
                            tooltip.html(provence + " 当年GDP：" + t + "亿元")
                                //todo!!
                                .style("visibility", "visible")
                                .style("left", (event.pageX + 10) + "px")
                                .style("top", (event.pageY - 10) + "px")
                            dxw_Broken_line_diagram();
                            bingtudraw(totaldata, currentYear);
                            showAvgPeople(totaldata, currentYear, provence);
                        })
                        .on("mouseout", function (d, i) {
                            //console.log(i);
                            d3.select(this)
                                .attr("stroke-width", "0.2px")
                            tooltip.style('visibility', 'hidden')
                        });
                }
                else {
                    var groups = svg.select("g");//svg中，代表小组容器g
                    var tooltip = d3.select("body")
                        .select("#fortooltip")
                        .attr("class", "tooltip")
                        .style("background-color", "#d3d3d3")
                        .style("border-radius", "3px")
                        .style("padding", "5px");
                    groups.selectAll("path")
                        .data(data.features)
                        // .enter()// enter+append !!If the body is initially empty, the above code will create six new DIV elements, append them to the body in-order
                        // .append("path")
                        .attr("class", "province")
                        .attr("stroke", "#333")
                        .attr("stroke-width", "0.2px")
                        .attr("info", (d, i) => covid[i])//添加数据到info
                        //todo!加一个省份名
                        .attr("fill", function (d, i) {//todo：转成线性变换！
                            return compute(linear(covid[i]))

                        })

                        .attr("d", (d, i) => geoPath(d))  //使用路径生成器
                        .on("click", function (d, i) {
                            console.log(i.properties.name);
                            //!!定义了省份名，用作各个的接口

                            provence = i.properties.name
                            province = provence
                            const change = d3.select(this)//this是选中的框的内容
                                .attr("stroke-width", "1.5px")
                            var t = change.attr("info")//数据被添加到了info
                            tooltip.html(provence + "当年GDP：" + t + "亿元")
                                //todo!!
                                .style("visibility", "visible")
                                .style("left", (event.pageX + 10) + "px")
                                .style("top", (event.pageY - 10) + "px")
                            console.log('tooltip!')
                            dxw_Broken_line_diagram();
                            bingtudraw(totaldata, currentYear);
                            showAvgPeople(totaldata, currentYear, provence);
                        })
                        .on("mouseout", function (d, i) {
                            //console.log(i);
                            d3.select(this)
                                .attr("stroke-width", "0.2px")
                            tooltip.style('visibility', 'hidden')
                        });


                }

            });
            var title = svg.select("#title")
                .text("中国各省GDP")
                .attr("font-weight",'bold')
                .attr("font-family",'Seihei')
                .attr("x", width / 2 - 150)
                .attr("y", 40)
                .attr("font-size", "30")
                .attr("fill", "rgb(209, 199, 199)")
            var title = svg.select("#content")
                .text(currentYear)
                .attr("font-weight",'bold')
                .attr("font-family",'Seihei')
                .attr("x", width / 2.5)
                .attr("y", 70)
                .attr("font-size", "20")
                .attr("fill", "rgb(209, 199, 199)")

        }
    </script>
    <style>
         /* body{
            color:rgb(13, 223, 209)
        }  */
        </style>
<script type="text/javascript">
    window.onload = function () {
        echart02();
        setTimeout(function (){echart01();},10)
            

        function echart01() {
            // 基于准备好的dom，初始化echarts实例
            var myChart = echarts.init(document.getElementById('bar'));

            // 指定图表的配置项和数据
            $.get('data/GDP1.json', function (data) {
                const updateFrequency = 2000;
                const countryColors = {
                    江苏省: '#00008b',
                    湖南省: 'rgb(223, 157, 13)',
                    辽宁省: '#ffde00',
                    北京市: '#002a8f',
                    天津市: '#003580',
                    上海市: 'rgb(15, 184, 217)',
                    广东省: 'rgb(146, 13, 223',
                    福建省: '#003897',
                    山东省: '#f93',
                    四川省: 'rgb(192, 223, 13)',
                    湖北省: '#024fa2',
                    浙江省: 'rgb(19, 193, 138)',
                    安徽省: '#00247d',
                    重庆市: '#ef2b2d',
                    江西省: '#dc143c',
                    吉林省: '#d52b1e',
                    黑龙江省: 'rgb(48, 223, 13)',
                    河南省: '#00247d',
                    河北省: 'rgb(223, 122, 13)'
                };
                const years = [];
                for (let i = 0; i < data.length; ++i) {
                    if (years.length === 0 || years[years.length - 1] !== data[i][0]) {
                        years.push(data[i][0]);
                    }
                }
                console.log(years);
                let startIndex = 0;
                let startYear = years[startIndex];
                option = {
                    title:{
                        text:"GDP race" ,
                        textStyle:{color:'rgb(209, 199, 199)',fontSize:20,fontWeight:'bolder'},
                        // orient: 'vertical',
                        // x:'left',
                        // y: 'center',
                        
                    },
                    grid: {
                        top: 25,
                        bottom: 30,
                        left: 95,
                        right: 80
                    },
                    toolbox: {
                        show: true,
                        feature: {
                            mark: {
                                show: true
                            },
                            mytool: {
                                show: true,
                                title: 'replay',
                                icon: 'path://M128 149.333333c11.946667 0 21.333333 9.386667 21.333333 21.333334v161.28C215.893333 198.826667 353.28 106.666667 512 106.666667c110.933333 0 214.613333 43.946667 291.84 123.733333 8.106667 8.533333 8.106667 22.186667-0.426667 30.293333-8.533333 8.106667-22.186667 8.106667-30.293333-0.426666A359.381333 359.381333 0 0 0 512 149.333333c-200.106667 0-362.666667 162.56-362.666667 362.666667 0 11.946667-9.386667 21.333333-21.333333 21.333333s-21.333333-9.386667-21.333333-21.333333V170.666667c0-11.946667 9.386667-21.333333 21.333333-21.333334zM260.266667 773.12A360.021333 360.021333 0 0 0 512 874.666667c200.106667 0 362.666667-162.56 362.666667-362.666667 0-11.946667 9.386667-21.333333 21.333333-21.333333s21.333333 9.386667 21.333333 21.333333v341.333333c0 11.946667-9.386667 21.333333-21.333333 21.333334s-21.333333-9.386667-21.333333-21.333334v-161.28c-66.56 133.546667-203.946667 225.28-362.666667 225.28-105.386667 0-205.653333-40.533333-281.6-113.92-8.533333-8.106667-8.533333-21.76-0.426667-30.293333 8.106667-8.106667 21.76-8.533333 30.293334 0z',
                                onclick: function () {
                                    location.reload()
                                }
                            }
                        }
                    },
                    xAxis: {
                        max: 'dataMax',
                        name: "GDP",
                        nameTextStyle:{//轴标题，在xAxis或yAxis根下
                            color:'white',
                            fontSize:15
                        },
                        axisLabel: {
                            formatter: function (n) {
                                return Math.round(n);
                            },
                            color:'rgb(209, 199, 199)',
                        }
                    },
                    dataset: {
                        source: data.slice(1).filter(function (d) {
                            return d[0] === startYear;
                        })
                    },
                    yAxis: {
                        type: 'category',
                        inverse: true,
                        max: 10,
                        axisLabel: {
                            show: true,
                            fontSize: 14,
                            formatter: function (value) {
                                return value;
                            },
                            color:'rgb(209, 199, 199)',
                            rich: {
                                flag: {
                                    fontSize: 25,
                                    padding: 5
                                }
                            }
                        },
                        animationDuration: 300,
                        animationDurationUpdate: 300
                    },
                    series: [{
                        realtimeSort: true,
                        seriesLayoutBy: 'column',
                        type: 'bar',
                        itemStyle: {
                            color: function (param) {
                                return countryColors[param.value[2]]||'#ffffff' ;
                            }
                        },
                        encode: {
                            x: 3,
                            y: 2
                        },
                        label: {
                            show: true,
                            precision: 1,
                            position: 'right',
                            valueAnimation: true,
                            textStyle: {
                                color: 'white',
                                fontSize: 13
                                ,  
                                opacity: 1,    
                        },
                           
                        }
                    }],
                    animationDuration: 3000,
                    animationDurationUpdate: 3000,
                    animationEasing: 'linear',
                    animationEasingUpdate: 'linear',
                    graphic: { //更改右下角的年份数字
                        elements: [{
                            type: 'text',
                            right: 60,
                            bottom: 40,
                            style: {
                                text: startYear,
                                font: '65px Seihei',
                                fill: 'rgb(209, 199, 199)',
                                
                            },
                            z: 100
                        }]
                    }
                };
                myChart.setOption(option);
                for (let i = startIndex; i < years.length - 1; ++i) {
                    (function (i) {
                        setTimeout(function () {
                            updateYear(years[i + 1]);
                        }, (i - startIndex) * updateFrequency);
                    })(i);
                }

                function updateYear(year) {
                    let source = data.slice(1).filter(function (d) {
                        return d[0] === year;
                    });
                    option.series[0].data = source;
                    console.log(year);
                    option.graphic.elements[0].style.text = year;
                    myChart.setOption(option);
                }
            });

            window.addEventListener('resize', myChart.resize);
        }







        
        function echart02() {
            var myChart = echarts.init(document.getElementById('line2ykn'));//去掉dark按钮有问题

            // 指定图表的配置项和数据
            $.get('data/GDP.json', function (data) {
                option = {
                    title:{
                        text:"人均GDP" ,
                        textStyle:{
                                    color:'rgb(209, 199, 199)'}
                    },
                    dataset: [{
                        id: "dataset_raw",
                        source: data
                    },
                    {
                        id: "广东省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '广东省'
                            }
                        },

                    },
                    {
                        id: "新疆维吾尔自治区",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '新疆维吾尔自治区'
                            }
                        }
                    },
                    {
                        id: "江苏省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '江苏省'
                            }
                        }
                    },
                    {
                        id: "黑龙江省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '黑龙江省'
                            }
                        }
                    },
                    {
                        id: "北京市",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '北京市'
                            }
                        }
                    },
                    {
                        id: "陕西省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '陕西省'
                            }
                        }
                    },
                    {
                        id: "安徽省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '安徽省'
                            }
                        }
                    },
                    {
                        id: "浙江省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '浙江省'
                            }
                        }
                    },
                    {
                        id: "宁夏回族自治区",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '宁夏回族自治区'
                            }
                        }
                    },
                    {
                        id: "内蒙古自治区",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '内蒙古自治区'
                            }
                        }
                    },
                    {
                        id: "山西省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '山西省'
                            }
                        }
                    },
                    {
                        id: "江西省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '江西省'
                            }
                        }
                    },
                    {
                        id: "河南省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '河南省'
                            }
                        }
                    },
                    {
                        id: "河北省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '河北省'
                            }
                        }
                    },
                    {
                        id: "天津市",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '天津市'
                            }
                        }
                    },
                    {
                        id: "广西壮族自治区",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '广西壮族自治区'
                            }
                        }
                    },
                    {
                        id: "吉林省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '吉林省'
                            }
                        }
                    },
                    {
                        id: "四川省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '四川省'
                            }
                        }
                    },
                    {
                        id: "青海省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '青海省'
                            }
                        }
                    },
                    {
                        id: "甘肃省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '甘肃省'
                            }
                        }
                    },
                    {
                        id: "福建省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '福建省'
                            }
                        }
                    },
                    {
                        id: "云南省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '云南省'
                            }
                        }
                    },
                    {
                        id: "山东省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '山东省'
                            }
                        }
                    },
                    {
                        id: "上海市",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '上海市'
                            }
                        }
                    },
                    {
                        id: "贵州省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '贵州省'
                            }
                        }
                    },
                    {
                        id: "湖北省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '湖北省'
                            }
                        }
                    },
                    {
                        id: "中国",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '中国'
                            }
                        }
                    },
                    {
                        id: "辽宁省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '辽宁省'
                            }
                        }
                    },
                    {
                        id: "湖南省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '湖南省'
                            }
                        }
                    },
                    {
                        id: "西藏自治区",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '西藏自治区'
                            }
                        }
                    },
                    {
                        id: "重庆市",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '重庆市'
                            }
                        }
                    },
                    {
                        id: "海南省",
                        fromDatasetId: 'dataset_raw',
                        transform: {
                            type: 'filter',
                            config: {
                                dimension: '省份',
                                '=': '海南省'
                            }
                        }
                    }
                    ],
                    tooltip: {
                        trigger: 'axis'
                    },
                    grid: {//调整画出的图形和画布的间隔
                        top:40,
                        left: 90,
                        right: 200
                    },
                    // legend: {
                    //     type: 'scroll', // 可滚动翻页的图例
                    //     // orient: 'horizontal',//横向
                    //     orient: 'vertical',
                    //     y: 'center', //延Y轴居中
                    //     x: 'right', //居右显示
                    //     align: 'left',
                    //     pageIconColor: '#2C86FF', //翻页箭头颜色
                    //     pageIconInactiveColor: 'rgba(44,132,251,0.40)', //翻页（即翻页到头时箭头的颜色）
                    //     pageIconSize: 10, //翻页按钮大小
                    //     itemWidth: 16, // 设置宽度
                    //     itemHeight: 16, // 设置高度
                    //     pageTextStyle: {
                    //         color: '#999', //翻页数字颜色
                    //     }, //翻页数字设置
                    //     data: "",
                    //     textStyle: {
                    //         color:'#ccc',
                    //         fontSize: 15,
                    //     },
                    //     selected: {
                    //         "中国": true,
                    //         "广东省": false,
                    //         "新疆维吾尔自治区": false,
                    //         "江苏省": false,
                    //         "黑龙江省": false,
                    //         "北京市": false,
                    //         "陕西省": false,
                    //         "安徽省": false,
                    //         "浙江省": false,
                    //         "宁夏回族自治区": false,
                    //         "内蒙古自治区": false,
                    //         "山西省": false,
                    //         "江西省": false,
                    //         "河南省": false,
                    //         "河北省": false,
                    //         "天津市": false,
                    //         "广西壮族自治区": false,
                    //         "吉林省": false,
                    //         "四川省": false,
                    //         "青海省": false,
                    //         "甘肃省": false,
                    //         "福建省": false,
                    //         "云南省": false,
                    //         "山东省": false,
                    //         "上海市": false,
                    //         "贵州省": false,
                    //         "湖北省": false,
                    //         "辽宁省": false,
                    //         "湖南省": false,
                    //         "西藏自治区": false,
                    //         "重庆市": false,
                    //         "海南省": false,
                    //     }
                    // },
                    legend: {
                         icon:'circle',
                         type: 'scroll', // 可滚动翻页的图例
                         // orient: 'horizontal',//横向
                         orient: 'vertical', 
                         y: 'center', //延Y轴居中
                         x: 'right', //居右显示
                         align:'left',
                         pageIconColor: '#2C86FF', //翻页箭头颜色
                         pageIconInactiveColor: 'rgba(44,132,251,0.40)', //翻页（即翻页到头时箭头的颜色）
                         pageIconSize: 10, //翻页按钮大小
                         itemWidth: 16, // 设置宽度
                         itemHeight: 16, // 设置高度
                         pageTextStyle: {
                              color: '#999', //翻页数字颜色
                         }, //翻页数字设置
                         data: "",
                         textStyle: {
                              color: "#ccc",
                              fontSize: 15,
                         },
                         selected: {
                              "中国": true,
                              "广东省": true,
                              "新疆维吾尔自治区": true,
                              "江苏省": true,
                              "黑龙江省": true,
                              "北京市": false,
                              "陕西省": false,
                              "安徽省": false,
                              "浙江省": false,
                              "宁夏回族自治区": false,
                              "内蒙古自治区": false,
                              "山西省": false,
                              "江西省": false,
                              "河南省": false,
                              "河北省": false,
                              "天津市": false,
                              "广西壮族自治区": false,
                              "吉林省": false,
                              "四川省": false,
                              "青海省": false,
                              "甘肃省": false,
                              "福建省": false,
                              "云南省": false,
                              "山东省": false,
                              "上海市": false,
                              "贵州省": false,
                              "湖北省": false,
                              "辽宁省": false,
                              "湖南省": false,
                              "西藏自治区": false,
                              "重庆市": false,
                              "海南省": false,
                         }
                    },
                    dataZoom: [{
                        type: 'slider',
                        show: true,
                        xAxisIndex: [0],
                        start: 85,
                        end: 100
                    },
                    // {
                    // type: 'slider',
                    // show: true,
                    // yAxisIndex: [0],
                    // left: '93%',
                    // start: 29,
                    // end: 36
                    // },
                    {
                        type: 'inside',
                        xAxisIndex: [0],
                        start: 1,
                        end: 35
                    },
                        // {
                        // type: 'inside',
                        // yAxisIndex: [0],
                        // start: 29,
                        // end: 36
                        // }
                    ],
                    xAxis: [{
                        type: 'category',
                        name: '年份',
                        nameTextStyle:{//轴标题，在xAxis或yAxis根下
                            color:'white',
                            fontSize:15
                        },
                        axisLabel: {
                            color:'rgb(209, 199, 199)',//rgb(209, 199, 199)
                            
                        },
                        
                        // axisTick: {
                        // alignWithLabel: true
                        // }
                    }],
                    yAxis: [{
                        type: 'value',
                        // name: '人均GDP',
                        axisLabel: {
                            color:'rgb(209, 199, 199)',
                            
                        },
                    }],

                    series: [{
                        type: 'line',
                        datasetId: "中国",
                        name: "中国",
                        showSymbol: false,
                        
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "广东省",
                        name: "广东省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "新疆维吾尔自治区",
                        name: "新疆维吾尔自治区",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "江苏省",
                        name: "江苏省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "黑龙江省",
                        name: "黑龙江省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "北京市",
                        name: "北京市",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "陕西省",
                        name: "陕西省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "安徽省",
                        name: "安徽省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "浙江省",
                        name: "浙江省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "宁夏回族自治区",
                        name: "宁夏回族自治区",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "内蒙古自治区",
                        name: "内蒙古自治区",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "山西省",
                        name: "山西省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "江西省",
                        name: "江西省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "河南省",
                        name: "河南省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "河北省",
                        name: "河北省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "天津市",
                        name: "天津市",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "广西壮族自治区",
                        name: "广西壮族自治区",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "吉林省",
                        name: "吉林省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "四川省",
                        name: "四川省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "青海省",
                        name: "青海省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "甘肃省",
                        name: "甘肃省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "福建省",
                        name: "福建省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "云南省",
                        name: "云南省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "山东省",
                        name: "山东省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "上海市",
                        name: "上海市",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "贵州省",
                        name: "贵州省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "湖北省",
                        name: "湖北省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "辽宁省",
                        name: "辽宁省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "湖南省",
                        name: "湖南省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "西藏自治区",
                        name: "西藏自治区",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "重庆市",
                        name: "重庆市",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    },
                    {
                        type: 'line',
                        datasetId: "海南省",
                        name: "海南省",
                        showSymbol: false,
                        encode: {
                            itemName: "年份",
                            x: '年份',
                            y: '人均地区生产总值_元',
                            tooltip: ['人均地区生产总值_元']
                        }
                    }
                    ]
                };

                myChart.setOption(option);
            });
            window.addEventListener('resize', myChart.resize);
        }

    }
</script>
</body>

</html>